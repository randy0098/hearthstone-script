[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=0
PauseHotkeyMod=0
StopHotkey=123
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=7064e70b-6b65-47e9-ac51-6600a81db2ea
Description=炉石传说
Enable=0
AutoRun=0
[Repeat]
Type=0
Number=1
[SetupUI]
Type=2
QUI=
[Relative]
SetupOCXFile=
[Comment]

[Attachment]
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


[Script]
PutAttachment "C:\Work\Anjian\anjian\hearthstone\resource" ,"*.*"
PutAttachment ".\Plugin" ,"RegDll.dll"
Call Plugin.RegDll.Reg("C:\Work\Anjian\anjian\hearthstone\resource\dm.dll")
Set dm = createobject("dm.dmsoft")
dm_ret = dm.SetPath("C:\Work\Anjian\anjian\hearthstone\resource")
dm_ret = dm.setDict(0,"number.txt")
TracePrint dm.Ver()

//注意变量和常量要放置到脚本最前面
Const windowX = 1920
Const windowY = 1080 

result = getCrystalNum()

/*
Function getRoundHint()
	//dm_ret = dm.FindPic(0, 0, 1920, 1080, "Attachment:\test.bmp", "000000", 0.9, 0, intX, intY)
	FindPic 0,0,1920,1080,"Attachment:\test.bmp",0.9,intX,intY 
	TracePrint CStr(intX) + ":" + CStr(intY)
	MoveTo intX,intY
End Function

	MoveTo intX,intY
	XY = Plugin.ColorEx.FindPic(0, 0, 1920, 1080, "Attachment:\du.bmp", 1, 0)
	dm_ret = dm.FindPic(0, 0, 1920, 1080, "Attachment:\du.bmp", "000000", 0.9, 0, intX1, intY1)
*/



//获得是自己回合还是对方回合
Function getWhosTurn()
	FindPic 0, 0, 1920, 1080, "Attachment:\finishTurn.bmp", 0.9, intX, intY
	FindPic 0, 0, 1920, 1080, "Attachment:\opponentTurn.bmp", 0.9, intA, intB
	TracePrint CStr(intX) + ":" + CStr(intY)
	TracePrint CStr(intA) + ":" + CStr(intB)
	MoveTo intX, intY
	If intX <> - 1  Then 
		result = "myTurn"
	ElseIf intA <> - 1  Then
		result = "opponentTurn"
	End If
	TracePrint "getWhosTurn:"+result
End Function

//获得自己手牌的水晶数
Function getCrystalNum()
	crystalNum = dm.OcrEx(0, 0, 1920, 1080, "3C2F05-3C2F05", 1.0)
	TracePrint "crystalNum:"+crystalNum
End Function